---
// Astro
import menuIcon from "../../public/svg/menu.svg?url";
---

<style>
  html {
    scroll-behavior: smooth;
  }

  .nav-link.active::after {
    content: "";
    position: absolute;
    left: 0;
    bottom: 0;
    width: 50%;
    height: 3px;
    background-color: var(--color-secundario);
    border-radius: 9999px;
  }
</style>

<header class="sticky top-0 z-50 bg-[var(--color-principal)] shadow-sm">
  <div class="max-w-7xl mx-auto flex justify-between items-center px-6 py-4">
    <!-- Logo adaptado -->
    <a href="#inicio" class="flex items-center">
      <img
        src="/SAVANT_ACADEMIA.png"
        alt="Savant Academia"
        class="h-15 md:h-15 w-auto object-contain rounded-lg"
        style="margin:0;"
      />
    </a>

    <!-- Desktop Nav -->
    <nav class="hidden md:flex gap-6 text-white font-medium">
      <a
        href="#inicio"
        class="nav-link relative pb-1 transition-all duration-300">Inicio</a
      >
      <a
        href="#beneficios"
        class="nav-link relative pb-1 transition-all duration-300">Beneficios</a
      >
      <a
        href="#planes"
        class="nav-link relative pb-1 transition-all duration-300">Planes</a
      >
      <a
        href="#contacto"
        class="nav-link relative pb-1 transition-all duration-300">Contacto</a
      >
    </nav>

    <!-- Mobile Menu Icon -->
    <button class="md:hidden" id="mobileMenuBtn" aria-label="Abrir menÃº">
      <img src={menuIcon} alt="Menu" class="w-6 h-6 invert brightness-200" />
    </button>
  </div>

  <!-- Mobile Menu Dropdown -->
  <div
    id="mobileMenu"
    class="hidden md:hidden px-6 pb-4 flex-col gap-3 text-white"
  >
    <a href="#inicio" class="nav-link">Inicio</a>
    <a href="#beneficios" class="nav-link">Beneficios</a>
    <a href="#planes" class="nav-link">Planes</a>
    <a href="#contacto" class="nav-link">Contacto</a>
  </div>

  <script type="module" is:inline>
    const links = document.querySelectorAll(".nav-link");
    const sections = ["inicio", "beneficios", "planes", "contacto"];

    const activateLink = (id) => {
      links.forEach((l) =>
        l.classList.remove("text-[#001d52]", "font-semibold", "active")
      );
      const link = document.querySelector(`a[href="#${id}"]`);
      // Mantener texto blanco; solo resaltar con grosor y subrayado decorativo
      link?.classList.add("font-semibold", "active");
    };

    const observer = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            activateLink(entry.target.id);
          }
        });
      },
      { threshold: 0.6 }
    );

    // Observar secciones
    sections.forEach((id) => {
      const section = document.getElementById(id);
      if (section) observer.observe(section);
    });

    // ðŸ”¥ Forzar activaciÃ³n de "inicio" al cargar si estÃ¡ visible
    window.addEventListener("load", () => {
      const section = document.getElementById("inicio");
      if (section) {
        const rect = section.getBoundingClientRect();
        if (rect.top <= window.innerHeight && rect.bottom >= 0) {
          activateLink("inicio");
        }
      }
    });

    // Mobile menu toggle
    const btn = document.getElementById("mobileMenuBtn");
    const menu = document.getElementById("mobileMenu");
    btn.addEventListener("click", () => {
      const isHidden = menu.classList.toggle("hidden");
      if (!isHidden) {
        menu.classList.add("flex");
      } else {
        menu.classList.remove("flex");
      }
    });
  </script>
</header>
